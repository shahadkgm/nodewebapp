
<%- include("../../views/partials/user/header") %>

    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/swiper/6.8.4/swiper.min.css"> -->

    <style>
         .page-header {
            background-color: #f8f9fa;
            padding: 20px 0;
        }

        .breadcrumb {
            font-size: 14px;
            padding: 10px 0;
            margin: 0;
            background: none;
        }

        .breadcrumb a {
            color: #007bff;
            text-decoration: none;
        }

        .breadcrumb span {
            color: #6c757d;
        }

        .product-detail .detail-gallery {
            position: relative;
        }

        .product-detail .swiper-container {
            width: 100%;
            max-height: 400px;
            overflow: hidden;
        }

        .product-detail .swiper-slide img {
            width: 100%;
            height: auto;
            max-height: 400px;
            object-fit: cover;
            border-radius: 10px;
        }

        .swiper-button-next,
        .swiper-button-prev {
            color: #333;
            font-size: 18px;
            transition: color 0.3s ease;
        }

        .swiper-button-next:hover,
        .swiper-button-prev:hover {
            color: #000;
        }

        .detail-gallery .zoom-container {
            position: relative;
            overflow: hidden;
            cursor: zoom-in;
        }

        .detail-gallery .zoom-container img {
            transition: transform 0.3s ease;
            transform-origin: center center;
        }

        .detail-gallery .zoom-container:hover img {
            transform: scale(1.5);
        }

        .detail-gallery .zoom-lens {
            position: absolute;
            border: 1px solid #d4d4d4;
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.2);
            display: none;
            pointer-events: none;
        }

        /* Product Information */
        .detail-info {
            padding-left: 30px;
            display: flex;
            flex-direction: column;
        }

        .title-detail {
            font-size: 28px;
            font-weight: 600;
            margin-bottom: 20px;
        }

        .product-price {
            font-size: 24px;
            color: #28a745;
        }

        .product-price .old-price {
            color: #6c757d;
            text-decoration: line-through;
        }

        .save-price {
            color: #dc3545;
        }

        .short-desc p {
            font-size: 16px;
            line-height: 1.5;
            margin-bottom: 20px;
        }

        .product-meta {
            margin-top: 20px;
        }

        .product-meta li {
            margin-bottom: 5px;
        }

        .product-meta .in-stock {
            color: #28a745;
        }

        .product-detail-rating {
            margin-bottom: 20px;
        }

        .detail-gallery img {
            max-width: 100%;
        }

        .related-products ul {
            padding: 0;
            list-style: none;
        }

        .related-products ul li {
            margin-bottom: 15px;
        }

        .related-products ul li img {
            border-radius: 5px;
            margin-right: 10px;
        }

        /* Add to Cart Button */
        .add-to-cart-btn {
            background-color: #28a745;
            color: #fff;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            transition: background-color 0.3s ease;
        }

        .add-to-cart-btn:hover {
            background-color: #218838;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .detail-info {
                padding-left: 0;
                margin-top: 20px;
            }

            .title-detail {
                font-size: 24px;
            }

            .product-price {
                font-size: 20px;
            }

            .short-desc p {
                font-size: 14px;
            }
        }
    </style>

     
  
  <style>
.custom-navbar {
    padding: 20px 0;
    transition: all 0.3s ease;
    background: #3b5d50 !important;  
}

.navbar-brand {
    font-size: 28px;
    font-weight: 700;
    color: #ffffff !important;
}

.navbar-brand span {
    color: #198754;  
}

.custom-navbar-nav .nav-link {
    font-weight: 500;
    color: #ffffff !important;
    position: relative;
    padding: 10px 15px !important;
    transition: all 0.3s ease;
}

.custom-navbar-nav .nav-link:hover {
    color: #198754 !important;
}

.custom-navbar-nav .nav-item.active .nav-link {
    color: #198754 !important;
}

.dropdown {
    position: relative;
    display: inline-block;
    padding: 0 15px;
}

.dropdown a {
    color: #ffffff !important;
    font-weight: 500;
    transition: all 0.3s ease;
}

.dropdown a:hover {
    color: #198754 !important;
}

.dropdown-content {
    display: none;
    position: absolute;
    background-color: #ffffff;
    min-width: 180px;
    box-shadow: 0 8px 16px rgba(0,0,0,0.1);
    border-radius: 8px;
    overflow: hidden;
    z-index: 1000;
    right: 0;
    top: 100%;
    margin-top: 10px;
}

.dropdown-content::before {
    content: '';
    position: absolute;
    top: -8px;
    right: 20px;
    border-left: 8px solid transparent;
    border-right: 8px solid transparent;
    border-bottom: 8px solid #ffffff;
}

.dropdown-content a {
    color: #333333 !important;
    padding: 12px 20px;
    text-decoration: none;
    display: block;
    transition: all 0.3s ease;
    font-size: 14px;
}

.dropdown-content a:hover {
    background-color: #f8f9fa;
    color: #198754 !important;
}

.dropdown:hover .dropdown-content {
    display: block;
}

.custom-navbar-cta {
    margin-left: 20px !important;
}

.custom-navbar-cta .nav-link {
    padding: 8px !important;
    position: relative;
}

.custom-navbar-cta img {
    width: 24px;
    filter: invert(1);  
    transition: all 0.3s ease;
}

.custom-navbar-cta .nav-link:hover img {
    transform: scale(1.1);
}

.navbar-toggler {
    border: none;
    padding: 0;
    width: 30px;
    height: 30px;
    position: relative;
}

.navbar-toggler:focus {
    box-shadow: none;
}

.navbar-toggler-icon {
    background-image: none;
    position: relative;
    transition: all 0.3s ease;
}

@media (max-width: 991.98px) {
    .custom-navbar {
        padding: 15px 0;
    }

    .navbar-collapse {
        background: #3b5d50;
        padding: 20px;
        margin-top: 15px;
        border-radius: 8px;
    }

    .custom-navbar-nav .nav-link {
        padding: 10px 0 !important;
    }

    .dropdown {
        padding: 0;
    }

    .dropdown-content {
        position: static;
        background-color: rgba(255,255,255,0.1);
        margin-top: 5px;
        box-shadow: none;
    }

    .dropdown-content::before {
        display: none;
    }

    .dropdown-content a {
        color: #ffffff !important;
    }

    .custom-navbar-cta {
        margin-left: 0 !important;
        margin-top: 15px;
    }
}
    </style>
    

    <main class="main">
        <!-- Breadcrumb Section -->
        <div class="page-header breadcrumb-wrap">
            <div class="container">
                <div class="breadcrumb">
                    <a href="/" rel="nofollow">Home</a>
                    <span></span>
                    <span>Product Detail Page</span>
                </div>
            </div>
        </div>

        <!-- Product Detail Section -->
        <section class="mt-50 mb-50">
            <div class="container">
                <div class="row">
                    <!-- Product Details -->
                    <div class="col-lg-9">
                        <div class="product-detail accordion-detail">
                            <div class="row mb-50">
                                <!-- Product Images -->
                                <div class="col-md-6 col-sm-12">
                                    <div class="detail-gallery">
                                        <div class="swiper-container product-image-slider">
                                            <div class="swiper-wrapper">
                                                <% product.productImages.forEach((image) => { %>
                                                    <div class="swiper-slide">
                                                        <figure class="border-radius-10 zoom-container">
                                                            <img
                                                                src="/uploads/product-images/<%= image %>"
                                                                alt="<%= product.name %>"
                                                                style="width: 100%; object-fit: cover;"
                                                                class="zoom-image"
                                                            />
                                                            <div class="zoom-lens"></div>
                                                        </figure>
                                                    </div>
                                                <% }); %>
                                            </div>
                                            <!-- Navigation buttons -->
                                            <div class="swiper-button-next"></div>
                                            <div class="swiper-button-prev"></div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Product Info -->
                                <div class="col-md-6 col-sm-12">
                                    <div class="detail-info">
                                        <h2 class="title-detail"><%= product.name %></h2>
                                        <div class="product-detail-rating"></div>
                                        <div class="clearfix product-price-cover">
                                            <div class="product-price primary-color float-left">
                                                <ins><span class="text-brand">₹<%= product.salePrice.toLocaleString('en-IN') %></span></ins>
                                                <span class="old-price font-md ml-15">
                                                    ₹<%= product.regularPrice.toLocaleString('en-IN') %>
                                                </span>
                                                <span class="save-price font-md color3 ml-15">
                                                    Save ₹<%= (product.regularPrice - product.salePrice).toLocaleString('en-IN') %>
                                                </span>
                                            </div>
                                            <div class="product-features">
                                                <div class="feature-item">
                                                    <i class="fas fa-truck feature-icon"></i>
                                                    <span>Free Delivery for orders above ₹999</span>
                                                </div>
                                                <div class="feature-item">
                                                    <i class="fas fa-undo feature-icon"></i>
                                                    <span>30-Day Return Policy</span>
                                                </div>
                                                <div class="feature-item">
                                                    <i class="fas fa-shield-alt feature-icon"></i>
                                                    <span>2 Year Warranty</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="short-desc mb-30">
                                            <p><%= product.description %></p>
                                        </div>
                                        <ul class="product-meta font-xs color-grey mt-50">
                                            <li>Availability:
                                                <span class="in-stock text-success ml-5">
                                                    <%= product.stock %>
                                                </span>
                                            </li>
                                        </ul>
                                        <button 
             class="add-to-cart-btn" 
             data-product-id="<%= products._id %>" 
             data-product-name="<%= products.productName %>"
           >
             Add to Cart
           </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Related Products -->
                    <div class="col-lg-3">
                        <div class="related-products">
                            <h4>Related Products</h4>
                            <ul class="list-unstyled">
                                <% if (relatedProducts && relatedProducts.length > 0) { %>
                                    <% relatedProducts.forEach((related) => { %>
                                        <li class="mb-2 d-flex align-items-center">
                                            <a href="/product/<%= related._id %>" class="text-decoration-none d-flex align-items-center">
                                                <img
                                                    src="/uploads/product-images/<%= related.productImage[0] %>"
                                                    alt="<%= related.productName %>"
                                                    style="width: 50px; height: 50px; object-fit: cover; margin-right: 10px; border-radius: 5px;"
                                                />
                                                <span><%= related.productName %></span>
                                            </a>
                                            <p class="mb-0 text-muted small">
                                                ₹<%= related.salePrice.toLocaleString('en-IN') %>
                                            </p>
                                        </li>
                                    <% }); %>
                                <% } else { %>
                                    <li>No related products found.</li>
                                <% } %>
                            </ul>
                        </div>
                    </div>
                    <h5>Quality: We prioritize high-quality products and services.
                        Customer Focused: We go the extra mile to ensure customer satisfaction.
                        Innovation: We're always looking for new ways to serve our customers better.
                        Sustainability: We are committed to environmentally-friendly practices and solutions.</h5>
                </div>
            </div>
        </section>
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/swiper/6.8.4/swiper.min.js"></script>
    <script>
        const swiper = new Swiper('.product-image-slider', {
            loop: false,
            slidesPerView: 1,
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
            },
            effect: 'slide',
            spaceBetween: 0,
        });

        // Image Zoom Functionality
        document.querySelectorAll('.zoom-container').forEach(container => {
            const image = container.querySelector('.zoom-image');
            const lens = container.querySelector('.zoom-lens');

            container.addEventListener('mousemove', (e) => {
                lens.style.display = 'none';

                const containerRect = container.getBoundingClientRect();
                const x = e.clientX - containerRect.left;
                const y = e.clientY - containerRect.top;

                lens.style.left = `${x - lens.offsetWidth / 2}px`;
                lens.style.top = `${y - lens.offsetHeight / 2}px`;

                const percentX = (x / container.offsetWidth) * 100;
                const percentY = (y / container.offsetHeight) * 100;
                image.style.transformOrigin = `${percentX}% ${percentY}%`;
            });

             
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll(".add-to-cart-btn").forEach(button => {
          button.addEventListener("click", async function () {
            const productId = this.getAttribute("data-product-id");
            const productName = this.getAttribute("data-product-name");
    
            try {
              const response = await fetch("/add", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ productId, quantity: 1 }) // Default to 1 quantity
              });
    
              const data = await response.json();
              
              if (data.success) {
                Swal.fire({
                  icon: "success",
                  title: "Added to Cart!",
                  text: `"${productName}" has been added to your cart.`,
                  showConfirmButton: false,
                  timer: 1500
                });
              } else {
                Swal.fire({
                  icon: "error",
                  title: "Oops...",
                  text: data.message
                });
              }
            } catch (error) {
              console.error("Error adding to cart:", error);
              Swal.fire({
                icon: "error",
                title: "Error",
                text: "Something went wrong. Please try again later."
              });
            }
          });
        });
      });
    </script>
</body>
</html>